<div class="p-6 max-w-3xl mx-auto rtl font-sans">
  <h1 class="text-2xl font-bold mb-6">تعديل التشطيب</h1>

  <div *ngIf="isLoading" class="text-gray-500">جار التحميل...</div>
  <div *ngIf="errorMessage" class="text-red-500 mb-4">{{ errorMessage }}</div>

  <form *ngIf="finish">
    <!-- الصور الرئيسية -->
    <div class="mb-4">
      <label class="block mb-2 font-semibold">الصورة الرئيسية:</label>
      <input type="file" (change)="onFileChange($event, 'main_image')" class="mb-2" />
      <img *ngIf="finish.main_image" [src]="finish.main_image" class="h-32 w-32 object-cover rounded mb-2" />
    </div>

    <!-- الفينيشات -->
    <div class="mb-4">
      <h2 class="font-bold mb-2">قائمة الفينيشات</h2>
      <button type="button" (click)="addFinishy()" class="bg-green-500 text-white px-3 py-1 rounded mb-2">إضافة فينيش</button>

      <div *ngFor="let f of finish.finishies; let i = index" class="border p-3 mb-2 rounded">
        <label class="block mb-1 font-semibold">اسم الفينيش:</label>
        <input type="text" [(ngModel)]="f.name" name="finishyName{{i}}" class="border p-1 w-full mb-2" />

        <label class="block mb-1 font-semibold">صورة الفينيش:</label>
        <input type="file" (change)="onFileChange($event, 'finishies['+i+'].image')" class="mb-2" />
        <img *ngIf="f.image" [src]="f.image" class="h-24 w-24 object-cover rounded mb-2" />

        <label class="block mb-1 font-semibold">الخصائص:</label>
        <textarea [(ngModel)]="f.properties" name="finishyProps{{i}}" class="border p-1 w-full mb-2" placeholder="افصل الخصائص بفاصلة"></textarea>

        <button type="button" (click)="removeFinishy(i)" class="bg-red-500 text-white px-2 py-1 rounded">حذف فينيش</button>
      </div>
    </div>

    <!-- العمليات -->
    <div class="mb-4">
      <h2 class="font-bold mb-2">العمليات</h2>
      <button type="button" (click)="addProcess()" class="bg-green-500 text-white px-3 py-1 rounded mb-2">إضافة عملية</button>

      <div *ngFor="let p of finish.process; let i = index" class="border p-3 mb-2 rounded">
        <label class="block mb-1 font-semibold">اسم العملية:</label>
        <input type="text" [(ngModel)]="p.name" name="processName{{i}}" class="border p-1 w-full mb-2" />

        <label class="block mb-1 font-semibold">وصف العملية:</label>
        <textarea [(ngModel)]="p.description" name="processDesc{{i}}" class="border p-1 w-full mb-2"></textarea>

        <label class="block mb-1 font-semibold">أيقونة العملية:</label>
        <input type="file" (change)="onFileChange($event, 'process['+i+'].icon_image')" class="mb-2" />
        <img *ngIf="p.icon_image" [src]="p.icon_image" class="h-16 w-16 object-cover rounded mb-2" />

        <button type="button" (click)="removeProcess(i)" class="bg-red-500 text-white px-2 py-1 rounded">حذف عملية</button>
      </div>
    </div>

    <div class="flex gap-2">
      <button type="button" (click)="onCancel()" class="bg-gray-400 text-white px-4 py-2 rounded">إلغاء</button>
      <button type="button" (click)="onSubmit()" class="bg-blue-500 text-white px-4 py-2 rounded">حفظ التغييرات</button>
    </div>
  </form>
</div>
